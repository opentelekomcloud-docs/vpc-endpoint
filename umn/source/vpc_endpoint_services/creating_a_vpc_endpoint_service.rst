:original_name: en-us_topic_0131645182.html

.. _en-us_topic_0131645182:

Creating a VPC Endpoint Service
===============================

Scenarios
---------

There are two types of VPC endpoint services: gateway and interface.

-  Gateway VPC endpoint services are created only for cloud services.
-  Interface VPC endpoint services can be created for both cloud services and your private services. Cloud services are configured as VPC endpoint services by the O&M personnel by default. However, you need to create VPC endpoint services for your private services.

This section describes how to configure a private service into an interface VPC endpoint service.

Constraints
-----------

-  VPC endpoint services are region-level resources. Select a region and project when you create such a service.
-  Each tenant can create a maximum of 20 VPC endpoint services.
-  The following private services can be configured into VPC endpoint services:

   -  **Elastic load balancer**: Backend resources of this type suit services that receive high access traffic and demand high reliability and disaster recovery (DR) performance.
   -  **ECS**: Backend resources of this type serve as servers.
   -  **BMS**: Backend resources of this type serve as servers. **BMS** will be discarded. You are recommended to choose **Elastic load balancer**.

   -  **VIP**: Backend resources of this type serve as virtual IP addresses. The VIP type will be discarded. The ELB type is recommended.

-  One VPC endpoint service can have only one backend resource.

Prerequisites
-------------

There is a load balancer in the VPC where you are going to create the VPC endpoint service.

Procedure
---------

#. Log in to the management console.

#. Click |image1| in the upper left corner and select the required region and project.

#. Click **Service List** and choose **Networking** > **VPC Endpoint**.

#. In the navigation pane on the left, choose **VPC Endpoint** > **VPC Endpoint Services**. In the upper right corner, click **Create VPC Endpoint Service**.

   The **Create VPC Endpoint Service** page is displayed.


   .. figure:: /_static/images/en-us_image_0000001979891805.png
      :alt: **Figure 1** Create VPC Endpoint Service

      **Figure 1** Create VPC Endpoint Service

#. Configure parameters by referring to :ref:`Table 1 <en-us_topic_0131645182__en-us_topic_0132331143_table20351132821713>`.

   .. _en-us_topic_0131645182__en-us_topic_0132331143_table20351132821713:

   .. table:: **Table 1** Parameters for creating a VPC endpoint service

      +-----------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Parameter                         | Description                                                                                                                                                                                                                                                                                                                                             |
      +===================================+=========================================================================================================================================================================================================================================================================================================================================================+
      | Region                            | Specifies the region where the VPC endpoint service is to be deployed.                                                                                                                                                                                                                                                                                  |
      |                                   |                                                                                                                                                                                                                                                                                                                                                         |
      |                                   | Resources in different regions cannot communicate with each other over an intranet. For lower latency and quicker access, select the nearest region.                                                                                                                                                                                                    |
      +-----------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Name                              | This parameter is optional.                                                                                                                                                                                                                                                                                                                             |
      |                                   |                                                                                                                                                                                                                                                                                                                                                         |
      |                                   | Specifies the name of the VPC endpoint service.                                                                                                                                                                                                                                                                                                         |
      |                                   |                                                                                                                                                                                                                                                                                                                                                         |
      |                                   | The name can contain a maximum of 16 characters, including letters, digits, underscores (_), and hyphens (-).                                                                                                                                                                                                                                           |
      |                                   |                                                                                                                                                                                                                                                                                                                                                         |
      |                                   | -  If you do not enter a name, the system generates a name in **{region}.{service_id}** format, for example, **eu-de.69e93219-e3ad-43b9-8416-9d788319ac9f**.                                                                                                                                                                                            |
      |                                   | -  If you enter a name, the system generates a name in **{region}.{Name}.{service_id}** format, for example, **eu-de.test.e9c186ca-99e4-4a88-9011-8898f1d680c0**.                                                                                                                                                                                       |
      +-----------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | VPC                               | Specifies the VPC where the VPC endpoint service is to be deployed.                                                                                                                                                                                                                                                                                     |
      +-----------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Service Type                      | Specifies the type of the VPC endpoint service. The type can only be **Interface**.                                                                                                                                                                                                                                                                     |
      +-----------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Connection Approval               | Specifies whether the connection between a VPC endpoint and a VPC endpoint service requires approval from the owner of the VPC endpoint service.                                                                                                                                                                                                        |
      |                                   |                                                                                                                                                                                                                                                                                                                                                         |
      |                                   | You can enable or disable **Connection Approval**.                                                                                                                                                                                                                                                                                                      |
      |                                   |                                                                                                                                                                                                                                                                                                                                                         |
      |                                   | When **Connection Approval** is enabled, any VPC endpoint for connecting to the VPC endpoint service needs to be approved. For details, see :ref:`Managing Connections of a VPC Endpoint Service <vpcep_03_0104>`.                                                                                                                                      |
      +-----------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Port Mapping                      | Specifies the protocol and ports used for communications between the VPC endpoint service and a VPC endpoint. The protocol is TCP.                                                                                                                                                                                                                      |
      |                                   |                                                                                                                                                                                                                                                                                                                                                         |
      |                                   | -  **Service Port**: provided by the backend resource bound to the VPC endpoint service.                                                                                                                                                                                                                                                                |
      |                                   | -  **Terminal Port**: provided by the VPC endpoint, allowing you to access the VPC endpoint service.                                                                                                                                                                                                                                                    |
      |                                   |                                                                                                                                                                                                                                                                                                                                                         |
      |                                   | The service and terminal port numbers range from **1** to **65535**. A maximum of 50 port mappings can be added at a time.                                                                                                                                                                                                                              |
      |                                   |                                                                                                                                                                                                                                                                                                                                                         |
      |                                   | .. note::                                                                                                                                                                                                                                                                                                                                               |
      |                                   |                                                                                                                                                                                                                                                                                                                                                         |
      |                                   |    Accessing a VPC endpoint service from a VPC endpoint is to access the service port from the associated terminal port.                                                                                                                                                                                                                                |
      |                                   |                                                                                                                                                                                                                                                                                                                                                         |
      |                                   |    After a port mapping is added, it cannot be modified or deleted.                                                                                                                                                                                                                                                                                     |
      +-----------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Backend Resource Type             | Specifies the backend resource that provides services to be accessed.                                                                                                                                                                                                                                                                                   |
      |                                   |                                                                                                                                                                                                                                                                                                                                                         |
      |                                   | The following backend resource types are supported:                                                                                                                                                                                                                                                                                                     |
      |                                   |                                                                                                                                                                                                                                                                                                                                                         |
      |                                   | -  **Elastic load balancer**: Backend resources of this type suit services that receive high access traffic and demand high reliability and disaster recovery (DR) performance.                                                                                                                                                                         |
      |                                   | -  **ECS**: Backend resources of this type serve as servers.                                                                                                                                                                                                                                                                                            |
      |                                   | -  **BMS**: Backend resources of this type serve as servers. **BMS** will be discarded. You are recommended to choose **Elastic load balancer**.                                                                                                                                                                                                        |
      |                                   |                                                                                                                                                                                                                                                                                                                                                         |
      |                                   | In this example, select **Elastic load balancer**.                                                                                                                                                                                                                                                                                                      |
      |                                   |                                                                                                                                                                                                                                                                                                                                                         |
      |                                   | .. note::                                                                                                                                                                                                                                                                                                                                               |
      |                                   |                                                                                                                                                                                                                                                                                                                                                         |
      |                                   |    For the security group associated with the backend resource configured for the VPC endpoint service, add an inbound rule, with **Source** set to **198.19.128.0/17**. For details, see `Adding a Security Group Rule <https://docs.otc.t-systems.com/en-us/usermanual/vpc/en-us_topic_0030969470.html>`__ in the *Virtual Private Cloud User Guide*. |
      +-----------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Load Balancer                     | When **Backend Resource Type** is set to **Elastic load balancer**, select the load balancer that provides services from the drop-down list.                                                                                                                                                                                                            |
      |                                   |                                                                                                                                                                                                                                                                                                                                                         |
      |                                   | .. note::                                                                                                                                                                                                                                                                                                                                               |
      |                                   |                                                                                                                                                                                                                                                                                                                                                         |
      |                                   |    If an elastic load balancer is used as the backend resource, the source IP address received by the VPC endpoint service is not the real address of the client.                                                                                                                                                                                       |
      +-----------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | ECS List                          | When you select **ECS** for **Backend Resource Type**, select an ECS from the ECS list.                                                                                                                                                                                                                                                                 |
      +-----------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | BMS List                          | When you select **BMS** for **Backend Resource Type**, select a BMS from the BMS list.                                                                                                                                                                                                                                                                  |
      |                                   |                                                                                                                                                                                                                                                                                                                                                         |
      |                                   | .. note::                                                                                                                                                                                                                                                                                                                                               |
      |                                   |                                                                                                                                                                                                                                                                                                                                                         |
      |                                   |    The BMS type will be discarded. The ELB type is recommended.                                                                                                                                                                                                                                                                                         |
      +-----------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Tag                               | This parameter is optional.                                                                                                                                                                                                                                                                                                                             |
      |                                   |                                                                                                                                                                                                                                                                                                                                                         |
      |                                   | Specifies the VPC endpoint service tag, which consists of a key and a value. You can add up to 20 tags to each VPC endpoint service.                                                                                                                                                                                                                    |
      |                                   |                                                                                                                                                                                                                                                                                                                                                         |
      |                                   | Tag keys and values must meet requirements listed in :ref:`Table 2 <en-us_topic_0131645182__en-us_topic_0132331143_table539113432713>`.                                                                                                                                                                                                                 |
      |                                   |                                                                                                                                                                                                                                                                                                                                                         |
      |                                   | .. note::                                                                                                                                                                                                                                                                                                                                               |
      |                                   |                                                                                                                                                                                                                                                                                                                                                         |
      |                                   |    If a predefined tag has been created on TMS, you can directly select the corresponding tag key and value.                                                                                                                                                                                                                                            |
      |                                   |                                                                                                                                                                                                                                                                                                                                                         |
      |                                   |    For details about predefined tags, see `Predefined Tag Overview <https://docs.otc.t-systems.com/usermanual/tms/en-us_topic_0056266269.html>`__.                                                                                                                                                                                                      |
      +-----------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

   .. _en-us_topic_0131645182__en-us_topic_0132331143_table539113432713:

   .. table:: **Table 2** Tag requirements for VPC endpoint services

      +-----------------------------------+--------------------------------------------------------------------------------------+
      | Parameter                         | Requirement                                                                          |
      +===================================+======================================================================================+
      | Tag key                           | -  Cannot be left blank.                                                             |
      |                                   | -  Must be unique for each resource.                                                 |
      |                                   | -  Can contain a maximum of 36 characters.                                           |
      |                                   | -  Can contain only digits, letters, hyphens (-), underscores (_), and at signs (@). |
      +-----------------------------------+--------------------------------------------------------------------------------------+
      | Tag value                         | -  Can contain a maximum of 43 characters.                                           |
      |                                   | -  Can contain only digits, letters, hyphens (-), underscores (_), and at signs (@). |
      +-----------------------------------+--------------------------------------------------------------------------------------+

#. Click **Create Now**.

#. .. _en-us_topic_0131645182__li955435119157:

   Click **Back to VPC Endpoint Service List** to view the newly-created VPC endpoint service.


   .. figure:: /_static/images/en-us_image_0000001949612240.jpg
      :alt: **Figure 2** VPC endpoint service list

      **Figure 2** VPC endpoint service list

.. |image1| image:: /_static/images/en-us_image_0000001979891813.png
